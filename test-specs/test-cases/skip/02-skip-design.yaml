# 测试用例：跳过设计阶段
name: "跳过设计阶段"
description: "测试跳过设计文档阶段的功能"
category: "skip"
priority: "high"

setup:
  fixtures: "fixtures/skip/design-stage"
  target: "./e2e-test-skip-design"

request:
  method: "tools/call"
  params:
    name: "specs-workflow"
    arguments:
      path: "./e2e-test-skip-design"
      action:
        type: "skip"

expect:
  operation: "skip"
  # 验证跳过设计阶段的响应和副作用
  additional_checks:
    # 验证响应字段
    - type: "value_equals"
      path: "structuredContent.stage"
      value: "design"
      description: "当前阶段是设计（返回被跳过的阶段名）"
    - type: "value_equals"
      path: "structuredContent.skipped"
      value: true
      description: "应该显示已跳过"
    - type: "value_equals"
      path: "structuredContent.progress.overall"
      value: 60
      description: "整体进度应该是60%"
    # 验证文件系统副作用
    - type: "file_content"
      path: "./e2e-test-skip-design/.workflow-confirmations.json"
      contains: '"design":true'
      parent_key: "skipped"
      description: "设计阶段应该被标记为已跳过"
    - type: "file_exists"
      path: "./e2e-test-skip-design/tasks.md"
      description: "应该生成任务文档"
    - type: "file_content"
      path: "./e2e-test-skip-design/tasks.md"
      contains: "## Implementation Tasks"
      description: "任务文档应该包含任务标题"

cleanup: ["./e2e-test-skip-design"]