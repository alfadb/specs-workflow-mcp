# 测试用例：跳过任务阶段
name: "跳过任务阶段"
description: "测试跳过任务文档阶段的功能"
category: "skip"
priority: "medium"

setup:
  fixtures: "fixtures/skip/tasks-stage"
  target: "./e2e-test-skip-tasks"

request:
  method: "tools/call"
  params:
    name: "specs-workflow"
    arguments:
      path: "./e2e-test-skip-tasks"
      action:
        type: "skip"

expect:
  operation: "skip"
  # JSON Schema 验证会自动验证结构是否符合 OpenAPI 规范
  additional_checks:
    - type: "file_content"
      path: "./e2e-test-skip-tasks/.workflow-confirmations.json"
      contains: '"tasks":true'
      parent_key: "skipped"
      description: "任务阶段应该被标记为已跳过"
    # MCP 服务器不会在文档中添加跳过标记
    # - type: "file_content"
    #   path: "./e2e-test-skip-tasks/tasks.md"
    #   contains: "跳过原因"
    #   description: "任务文档应该包含跳过标记"
    # nextStage 字段在 SkipResponse 中不存在，暂时注释掉
    # - type: "value_equals"
    #   path: "structuredContent.nextStage"
    #   value: "completed"
    #   description: "下一阶段应该是已完成"

cleanup: ["./e2e-test-skip-tasks"]