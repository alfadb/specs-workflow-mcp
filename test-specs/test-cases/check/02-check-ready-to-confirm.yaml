# 测试用例：检查已完成的需求文档
name: "检查已完成的需求文档"
description: "测试检查需求文档已完成，准备确认的状态"

setup:
  fixtures: "fixtures/requirements/ready"
  target: "./e2e-test-check-ready"

request:
  method: "tools/call"
  params:
    name: "specs-workflow"
    arguments:
      path: "./e2e-test-check-ready"
      action:
        type: "check"

expect:
  operation: "check"
  # 验证准备确认的文档状态
  additional_checks:
    - type: "value_equals"
      path: "structuredContent.stage"
      value: "requirements"
      description: "当前阶段应该是需求"
    - type: "value_equals"
      path: "structuredContent.status.type"
      value: "ready_to_confirm"
      description: "状态类型应该是ready_to_confirm"
    - type: "value_equals"
      path: "structuredContent.status.readyToConfirm"
      value: false
      description: "文档虽然准备好但readyToConfirm仍为false"
    - type: "value_contains"
      path: "structuredContent.displayText"
      contains: "check passed"
      description: "应该提示检查通过"
    - type: "value_equals"
      path: "structuredContent.progress.requirements"
      value: 0
      description: "需求进度仍为0（未确认）"

cleanup: ["./e2e-test-check-ready"]